---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit the README.Rmd file -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

# Lab report #1

Follow the instructions posted at https://ds202-at-isu.github.io/labs.html for the lab assignment. The work is meant to be finished during the lab time, but you have time until Monday evening to polish things.

Include your answers in this document (Rmd file). Make sure that it knits properly (into the md file). Upload both the Rmd and the md file to your repository.  

All submissions to the github repo will be automatically uploaded for grading once the due date is passed.
Submit a link to your repository on Canvas (only one submission per team) to signal to the instructors that you are done with your submission.

## TL;DR

We looked at home sales in Ames and found that most houses sell for between $150,000 and $300,000, but there are some really expensive ones that push the average way up. The bigger the house, the more it tends to cost, which makes sense. We also noticed how a bunch of homes that sold for $0 (probably typos or family transfers) and some small houses that sold for a lot (probably because they're in nice areas). Where a house is located in Ames really matters for the price too.

```{r load-packages}
library(tidyverse)
library(classdata)
library(janitor)
```

## Step 1: Data Inspection and Cleaning

```{r load-data}
data("ames")
ames <- janitor::clean_names(ames)

# Initial data inspection
glimpse(ames)
```

```{r data-summary}
cat("Dataset dimensions:", dim(ames)[1], "rows ×", dim(ames)[2], "columns\n")
cat("Date range:", as.character(range(ames$sale_date, na.rm = TRUE)), "\n")
```

```{r initial-inspection}
# Check for missing values
missing_summary <- map_dbl(ames, ~sum(is.na(.))) %>% 
  tibble(variable = names(.), missing_count = .) %>%
  arrange(desc(missing_count))

print(missing_summary)

# Basic statistics for numerical variables
ames %>% 
  select(where(is.numeric)) %>% 
  summary()
```

**Key Findings**:
The dataset includes nearly 7,000 home sales with 16 variables, spanning July 3, 2017 to August 31, 2022. The main things we're looking at are the sale price, how big the house is, when it was built, and where it's located. Some things like air conditioning and fireplaces are just yes/no, while the prices and sizes are numbers. The prices vary, ranging from \$0 all the way up to several millions.The dataset isn't perfect though as there are gaps, especially around which homes were sold multiple times, the construction years, and basement sizes. But what's clear is that most properties are regular single-family homes ranging in 1,000-2,000 square feet.
It was interesting to see how much the housing market in Ames can vary, even within a small area. These differences make it clear that both location and home features play major roles in determining price. Overall, this dataset gives a realistic look into how diverse housing trends can be, even in one city.

## Step 2: Main Variable: Sale Price
This report focuses on Sale Price as the primary variable of interest, examining its relationships with other variables in the dataset.

## Step 3: Exploration of the Main Variable
```{r sale-price-basic}
price_summary <- ames %>%
  summarise(
    Mean = mean(sale_price, na.rm = TRUE),
    Median = median(sale_price, na.rm = TRUE),
    SD = sd(sale_price, na.rm = TRUE),
    Min = min(sale_price, na.rm = TRUE),
    Max = max(sale_price, na.rm = TRUE),
    Zero_Count = sum(sale_price == 0, na.rm = TRUE)
  )

print(price_summary)
```

```{r sale-price-visuals, fig.width=10, fig.height=6}
# Create a combined visualization
p1 <- ggplot(ames, aes(x = sale_price)) +
  geom_histogram(binwidth = 50000, fill = "darkred", alpha = 0.8) +
  labs(title = "A. Distribution of Sale Prices",
       x = "Sale Price (USD)", y = "Count") +
  scale_x_continuous(labels = scales::dollar) +
  theme_minimal()

p2 <- ggplot(ames, aes(y = sale_price)) +
  geom_boxplot(fill = "darkred", alpha = 0.7) +
  labs(title = "B. Boxplot of Sale Prices",
       y = "Sale Price (USD)") +
  scale_y_continuous(labels = scales::dollar) +
  theme_minimal()

# Combine plots
library(patchwork)
p1 + p2
```

**Key Findings**:
Looking at the sale prices, most homes are pretty affordable, with the typical house going for around \$170,900. But there are some expensive properties that push the average up over \$1 million. We found homes that sold for \$0, which seems off, probably data errors or family transfers. One house sold for \$20.5 million, which really skews the numbers.This shows that whole most homes in Ames fall within a reasonable price range, a few extreme outliers have a big impact on the overall averages. It also highlights why looking at both the mean and mediaan is important when analyzing data with large variations.

## Step 4: Individual Investigations

### Maurycy: Neighborhood Impact on Sale Prices
I decided to look at neighborhoods because I was curious about how much location really matters for home prices. Would it actually make that big of a difference if you're on one side of town versus another?

```{r data-cleaning-for-neighborhood}
# Create cleaned dataset for neighborhood analysis
ames_clean <- ames %>%
  filter(
    !is.na(sale_price), 
    sale_price > 0,
    !is.na(neighborhood)
  )
```

```{r neighborhood-analysis, fig.height=8}
# Calculate neighborhood statistics
neighborhood_stats <- ames_clean %>%
  group_by(neighborhood) %>%
  summarise(
    median_price = median(sale_price),
    mean_price = mean(sale_price),
    count = n(),
    .groups = 'drop'
  ) %>%
  filter(count >= 10) %>%  # Only neighborhoods with sufficient data
  arrange(desc(median_price))

# Create visualization
ggplot(neighborhood_stats, 
       aes(x = reorder(neighborhood, median_price), y = median_price)) +
  geom_col(fill = "darkred", alpha = 0.8) +
  coord_flip() +
  labs(
    title = "Median Sale Price by Neighborhood",
    subtitle = "Neighborhoods with 10+ sales",
    x = NULL,
    y = "Median Sale Price (USD)"
  ) +
  scale_y_continuous(labels = scales::dollar) +
  theme_minimal() +
  theme(axis.text.y = element_text(size = 8))
```

```{r neighborhood-detail}
# Show top and bottom neighborhoods
cat("Top 5 Most Expensive Neighborhoods:\n")
head(neighborhood_stats, 5) %>% 
  select(neighborhood, median_price, count) %>%
  print()

cat("\nBottom 5 Least Expensive Neighborhoods:\n")
tail(neighborhood_stats, 5) %>% 
  select(neighborhood, median_price, count) %>%
  print()
```

**Key Findings (Maurycy)**: 
Location really is everything in Ames real estate. The data shows a clear divide as premium areas like Veenker and Northridge Heights have median prices above \$300,000, while more affordable spots like Briardale and Meadow Village come in under \$150,000. This neighborhood effect is so strong that it can make a small house in a good area worth more than a big house in a less desirable one. The zip code might be more important than the square footage.

### Maya: Relationship between Sale Price and Year Built
I decided to look at and explore whether newer homes tend to sell for more money in Ames or if older homes do due to Ames being a college town. I expected to see that houses built in recent decades have higher prices because of updated designs, materials, locations, and features. 

```{r yearbuilt-clean}
#cleaned dataset for analysis
ames_year <- ames %>%
  filter(sale_price > 0, !is.na(year_built))
```

```{r arrange-clean}
#group by decade to get clearer summary
ames_decade <- ames_year %>%
  mutate(decade = (year_built %/% 10) * 10) %>%
  group_by(decade) %>%
  summarise(
    median_price = median(sale_price),
    mean_price = mean(sale_price),
    count = n(),
    .groups = "drop"
  ) %>%
  arrange(desc(median_price))

cat("Top 5 Most Expensive Decades:\n")
head(ames_decade, 5) %>%
  select(decade, median_price, count) %>%
  print()

cat("\nBottom 5 Least Expensive Decades:\n")
tail(ames_decade, 5) %>%
  select(decade, median_price, count) %>%
  print()
```

```{r visualization-comparison}
ggplot(ames_decade, aes(x = factor(decade), y = median_price)) +
  geom_col(fill = "orange", alpha = 0.8) +
  labs(
    title = "Median Sale Price by Decade Built",
    x = "Decade Built",
    y = "Median Sale Price (USD)"
  ) +
  scale_y_continuous(labels = scales::dollar) +
  theme_minimal()
```

```{r maya-yearbuilt-scatter, fig.width=8, fig.height=6}
ggplot(ames_year, aes(x = year_built, y = sale_price)) +
  geom_point(alpha = 0.4, color = "darkblue") +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(
    title = "Relationship Between Sale Price and Year Built (Scatterplot)",
    x = "Year Built",
    y = "Sale Price (USD)"
  ) +
  scale_y_continuous(labels = scales::dollar, limits = c(0, 800000)) +
  theme_minimal()
```

**Key Findings (Maya)**: 
Looking at the data, newer homes in Ames generally sell for higher prices than older ones. The decade bar chart shows that homes built after 1990 have much higher median sale prices, with the 2000s standing out as the most expensive decade. Homes built before 1950, on the other hand, had much lower sale prices overall. The scatterplot also supports this trend, showing a clear upward relationship between the year a home was built and its sale price. As the years increase, prices tend to rise, which makes sense because newer homes usually come with modern features, better materials, and more energy-efficient designs. Even though a few older homes still sold for high prices, they were likely renovated or located in more desirable neighborhoods. Overall, this analysis shows how a home’s construction year plays a major role in its value, but it also reminded me that location and quality can sometimes outweigh age when it comes to price.
